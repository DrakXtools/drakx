<list no-arch-libraries="on">

<from expand="binary">
  bash sh

  false true
  pwd reset

  ls
  cp ln mkdir mknod mv rm rmdir   
  chmod chown
  dd touch

  cat less
  tail head tee
  sort split cut
  grep

  cmp diff
  find
  file md5sum

  gzip zcat gunzip
  bzip2 bunzip2 bzcat

  df du

  <mode copy="dereference">
    vol_id <!-- needed by libDrakX -->
  </mode>

  packdrake
  cpio ftp tar
  rsync
  ssh scp
  telnet
  host

  date
  dmesg
  chroot
  sleep
  sync

  eject
  mount mount.nfs umount
  losetup

  ldconfig
  mingetty init
  reboot halt shutdown
  kill killall5 ps strace
  sed tr

  loadkeys tset stty

  ping hostname ifconfig route

  fdformat badblocks
  e2fsck fsck.ext2 fsck.ext3 mke2fs mkfs.ext2 mkfs.ext3 mkfs.ntfs resize2fs
  mkfs.ext3 mkfs.reiserfs mkfs.xfs mkfs.jfs
  debugfs dumpe2fs tune2fs
  fsck.xfs xfs_repair
  resize_reiserfs reiserfsck
  mkswap swapoff swapon
  <if ARCH="i.86|x86_64">
    fsck.jfs
    strings
  </if>
  <if ARCH="i.86|x86_64|ia64">
    ntfsresize
    mkdosfs
  </if>
  <if ARCH="ppc">
    hformat
  </if>

  <if-not ARCH="ppc">
    fdisk gpart
    testdisk
  </if-not>
  <if-not ARCH="ppc|sparc">
    sfdisk
   </if-not>
                     
  <if ARCH="ppc">
    pdisk 
  </if>
  dump dump.ext2 restore restore.ext2 dump.ext3 restore.ext3 dump.xfs restore.xfs
  parted partimage

  mdadm lvm2
  <if ARCH="i.86|x86_64|ia64">
    dmraid
  </if>

  lsmod
  insmod
  rmmod

  setserial
  mt stinit

  lspci lspcidrake

  rpm
  rpm2cpio rpmdb
  rpmquery rpmverify

  vim-minimal hexedit

  perl
  uniq
  wget

  awk clear dialog wc
  setterm

  <if ARCH="i.86|x86_64|ia64">
    dmidecode 
  </if>

  <if ARCH="i.86|x86_64">
    grub grub-install
  </if>
  <if ARCH="ia64">
    efibootmgr 
  </if>
  <if ARCH="ppc">
    ybin
    mkofboot ofpath
    nvsetenv
  </if>
  <if ARCH="sparc">
    silo
  </if>
</from>

<from>
  /usr/lib/kbd/keymaps/include
  <if ARCH="i.86|x86_64">    
    /usr/lib/kbd/keymaps/i386/include
    /usr/lib/kbd/keymaps/i386/azerty/be-latin1.map.gz <!-- this one is needed by be2-latin1 -->
  </if>
  /usr/share/misc/file/magic.mgc
  /usr/share/terminfo/l/linux
  /usr/share/pci.ids
  /var/run/utmp

  <if ARCH="i.86|x86_64">    
    <from dir="/lib/grub/ARCH-mandriva" expand="glob">
      stage1
      stage2
      *_stage1_5
    </from>
    /usr/lib/extipl/aldebaran.bin
  </if>

  <if ARCH="ppc">
    /usr/lib/yaboot/ofboot
    /usr/lib/yaboot/yaboot    
  </if>

  <from expand="command">
    perl -Mkeyboard -I/usr/lib/libDrakX -le 'print foreach keyboard::loadkeys_files()'
  </from>

  <if set="LANGUAGE_fr_FR">
    /usr/lib/gconv/gconv-modules
    /usr/lib/gconv/ISO8859-15.so
    /usr/share/locale/ISO-8859-15
    /usr/share/locale/fr_FR
    /usr/share/locale/fr/LC_MESSAGES/partimage.mo
  </if>
  <if set="LANGUAGE_pt_BR">
    /usr/lib/gconv/gconv-modules
    /usr/lib/gconv/ISO8859-15.so
    /usr/share/locale/ISO-8859-15
    /usr/share/locale/pt_BR
    /usr/share/locale/pt/LC_MESSAGES/partimage.mo
  </if>

  /sbin/mount.ntfs-3g <!-- can not be expanded as binary, not executable for all users -->
</from>

<from dir="/usr/lib/rpm" expand="glob">
  <mode copy="keep-links">
    rpmrc
    macros
    rpmpopt-*
  </mode>
</from>

<filter subst="/^__END__/ and $_ = '', close ARGV">
<from expand="main-perl">
  AutoLoader.pm
  strict.pm
  vars.pm
  warnings/register.pm
  warnings.pm
  Carp.pm
  Exporter.pm
  File/Path.pm
  File/Basename.pm
  ARCH-linux-thread-multi/re.pm
  ARCH-linux-thread-multi/Cwd.pm
  ARCH-linux-thread-multi/auto/Cwd/Cwd.so
  ARCH-linux-thread-multi/CORE/libperl.so
  ARCH-linux-thread-multi/auto/POSIX/autosplit.ix
  ARCH-linux-thread-multi/auto/POSIX/load_imports.al
  ARCH-linux-thread-multi/auto/POSIX/POSIX.so
  ARCH-linux-thread-multi/POSIX.pm
  ARCH-linux-thread-multi/XSLoader.pm
  ARCH-linux-thread-multi/lib.pm
  ARCH-linux-thread-multi/Socket.pm
  ARCH-linux-thread-multi/IO/Socket.pm
  ARCH-linux-thread-multi/IO.pm
  ARCH-linux-thread-multi/IO/Handle.pm
  ARCH-linux-thread-multi/Encode/Symbol.pm
  Symbol.pm
  SelectSaver.pm
  ARCH-linux-thread-multi/auto/DynaLoader/dl_findfile.al
  ARCH-linux-thread-multi/DynaLoader.pm
  ARCH-linux-thread-multi/auto/IO/IO.so
  ARCH-linux-thread-multi/auto/Socket/Socket.so
  ARCH-linux-thread-multi/Errno.pm
  ARCH-linux-thread-multi/IO/Socket/INET.pm
  ARCH-linux-thread-multi/IO/Socket/UNIX.pm
</from>
<from expand="perl">
  packdrake.pm
  MDV/Packdrakeng.pm
</from>
</filter>

<from dir="/etc">
  mke2fs.conf
  inputrc
  termcap
  protocols
  services
  ssh/ssh_config
</from>

<filter command="strip">
<from dir="/LIB">
  libnss_files.so.2
  libnss_dns.so.2
  libresolv.so.2
  ld-linux*.so.2
</from>
</filter>

<from dir="/usr/share/ldetect-lst" expand="glob">
    *table.gz
    dkms-modules.alias fallback-modules.alias
</from>

<from dir="/lib/module-init-tools">
  ldetect-lst-modules.alias
</from>

<filter command="../tools/simplify-drakx-modules">
  <from dir="." expand="collect-perl-files /usr/lib/libDrakX /usr/lib/libDrakX">
    <to dir="/usr/bin">
      rescue-doc drvinst lsparts
      guessmounts install_bootloader
      <if ARCH="i.86|x86_64">
	restore_ms_boot
      </if>
    </to>
    <to dir="/usr/sbin">
      partimage_whole_disk
    </to>
  </from>
  <from dir="/usr/lib/libDrakX" expand="glob">
    raid.pm <!-- required when needed in guessmounts -->
    fs/dmraid.pm <!-- required by fsedit -->
    partition_table/*.pm <!-- required by partimage_whole_disk -->
  </from>
</filter>

<from dir="/usr/LIB/drakx-installer-binaries">
  <to dir="/usr/bin">
    rescue-gui
  </to>
  <to dir="/usr/sbin">
    dhcp-client
  </to>
</from>
<from dir="/usr/bin">
  <to dir="/ka">
    bootable_flag.sh
    fdisk_to_desc
    gen_modprobe_conf.pl
    ka-d-client
    ka-d-server
    ka-d.sh
    ka_replication.sh
    make_initrd_grub
    make_initrd_lilo
    prepare_node.sh
    send_status.pl
    status_node.pl
    store_log.sh
  </to>
</from>
<from dir="/etc/ka">
  <to dir="/ka">
    replication.conf
  </to>
</from>
<from dir=".">
    <to dir="/usr/sbin">
      diskdrake-resize
    </to>
    <to dir="/usr/sbin">
      restore-image.sh
    </to>
    <to dir="/usr/lib">
      restore-image-lib.sh
    </to>
</from>
<if set="RESCUE_FLASH">
  <from expand="binary">
    dirname
    losetup
    mlabel
    nash
    pv
    sed
    usleep
  </from>
  <from dir="Flash/scripts" expand="glob">
    <to dir="/usr/bin">
      *
    </to>
  </from>
</if>

</list>
