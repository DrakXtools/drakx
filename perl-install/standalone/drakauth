#!/usr/bin/perl

use lib qw(/usr/lib/libDrakX);

use standalone;     #- warning, standalone must be loaded very first, for 'explanations'

use common;
use interactive;
use authentication;
use network::network;

read_all_conf('', my $netc = {}, my $_intf = {});

my $in = 'interactive'->vnew('su');


my $authentication = {}; # TODO

my $kind = authentication::to_kind($authentication);
my $meta_class = { getVarsFromSh("/etc/sysconfig/system") }->{META_CLASS};

main:
$in->ask_from(N("Authentication"), authentication::kind2description(),
	      [ 
	       { label => N("Authentication"), val => \$kind, type => 'list' , list => [ authentication::kinds($in->do_pkgs, $meta_class) ], format => \&authentication::kind2name },
	      ]) or $in->exit;

authentication::ask_parameters($in, $netc, $authentication, $kind) or goto main;

eval { 
    authentication::set($in, $netc, $authentication);
    network::network::write_conf($netc);
};
if (my $err = $@) {
    $in->ask_warn(N("Error"), formatError($err));
    goto main;
}


$in->exit;
