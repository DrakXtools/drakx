--- perl-install/standalone/draksec
+++ perl-install/standalone/draksec
@@ -127,23 +127,14 @@
 
 sub set_auth_value {
     my ($prog, $auth) = @_;
-    my $pamd;
-    if ($auth eq "root_passwd") {
-        my $pamd_line = "#%PAM-1.0\nauth include config-util\naccount include	config-util\nsession include config-util\n";
-	# Save resultant config file
-	# But before delete symlink if present
-		run_program::rooted($::prefix, "rm", "-f", "/etc/pam.d/$prog") || 0;
-		open($pamd, ">", "/etc/pam.d/$prog") or return 0;
-		print $pamd $pamd_line;
-		close($pamd);
-	} else {
-		my $pamd_line = "#%PAM-1.0\nauth include config-util-user\naccount include	config-util-user\nsession include config-util-user\n";
-	# Save resultant config file
-	# But before delete symlink if present
-		run_program::rooted($::prefix, "rm", "-f", "/etc/pam.d/$prog") || 0;
-		open($pamd, ">", "/etc/pam.d/$prog") or return 0;
-		print $pamd $pamd_line;
-		close($pamd);
+    if ($auth eq 'no_passwd') {
+        symlinkf('../../etc/pam.d/mandriva-console-auth', "/etc/pam.d/$prog");
+    } else {
+        symlinkf('../../etc/pam.d/mandriva-simple-auth', "/etc/pam.d/$prog");
+        my $value = $auth eq 'user_passwd' ? '<user>' : 'root';
+        substInFile {
+            s/^USER=.*/USER=$value/;
+        } "/etc/security/console.apps/$prog";
     }
 }
 
