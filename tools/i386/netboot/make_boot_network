#!/bin/sh

type=$1
#[ -z "$type" ] && { echo "usage: $0 <network card type> (eg: 3c59x)" ; exit 1; }
[ -z "$type" ] && type=3c90x

[ -e automatic.para ] || { echo "missing file automatic.para, create one based on automatic.para.default"; exit 1; }

ln -sf stage1.$type stage1
ln -sf stage2.$type stage2

mformat a:
mcopy {stage1,stage2} a:
perl -pe 'chomp; $_ .= " " . `cat automatic.para` if /^kernel/; $_ .= "\n"' menu.lst | mcopy - a:menu.lst


./grub --batch <<EOF
install (fd0)/stage1 d (fd0) (fd0)/stage2 p (fd0)/menu.lst $automatic
EOF
